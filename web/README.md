# tdl Web Interface

åŸºäºç°ä»£WebæŠ€æœ¯æ ˆä¸ºtdlæ„å»ºçš„Webå‰ç«¯ç•Œé¢ã€‚

## ğŸš€ æŠ€æœ¯æ ˆ

### åç«¯
- **Gin** - é«˜æ€§èƒ½Go Webæ¡†æ¶
- **WebSocket** - å®æ—¶è¿›åº¦æ›´æ–°å’Œé€šçŸ¥
- **CORS** - è·¨åŸŸèµ„æºå…±äº«æ”¯æŒ
- **é›†æˆtdlæ ¸å¿ƒ** - å¤ç”¨ç°æœ‰CLIåŠŸèƒ½

### å‰ç«¯  
- **React 18** - ç°ä»£åŒ–å‰ç«¯æ¡†æ¶
- **TypeScript** - ç±»å‹å®‰å…¨
- **Tailwind CSS** - å®ç”¨ä¼˜å…ˆçš„æ ·å¼æ¡†æ¶
- **Radix-UI** - æ— éšœç¢UIç»„ä»¶åº“
- **Vite** - å¿«é€Ÿæ„å»ºå·¥å…·
- **Zustand** - è½»é‡çº§çŠ¶æ€ç®¡ç†
- **React Query** - æœåŠ¡ç«¯çŠ¶æ€ç®¡ç†

## ğŸ—ï¸ é¡¹ç›®ç»“æ„

```
tdl/
â”œâ”€â”€ web/
â”‚   â”œâ”€â”€ backend/              # Go APIåç«¯
â”‚   â”‚   â”œâ”€â”€ api/             # APIè·¯ç”±å¤„ç†å™¨
â”‚   â”‚   â”œâ”€â”€ middleware/      # ä¸­é—´ä»¶
â”‚   â”‚   â”œâ”€â”€ websocket/       # WebSocketå¤„ç†
â”‚   â”‚   â””â”€â”€ server.go        # GinæœåŠ¡å™¨
â”‚   â””â”€â”€ frontend/            # Reactå‰ç«¯
â”‚       â”œâ”€â”€ src/
â”‚       â”‚   â”œâ”€â”€ components/  # UIç»„ä»¶
â”‚       â”‚   â”œâ”€â”€ pages/       # é¡µé¢ç»„ä»¶
â”‚       â”‚   â”œâ”€â”€ store/       # çŠ¶æ€ç®¡ç†
â”‚       â”‚   â”œâ”€â”€ hooks/       # è‡ªå®šä¹‰Hooks
â”‚       â”‚   â””â”€â”€ utils/       # å·¥å…·å‡½æ•°
â”‚       â”œâ”€â”€ package.json
â”‚       â””â”€â”€ tailwind.config.js
â”œâ”€â”€ cmd/web.go               # Webå‘½ä»¤
â””â”€â”€ scripts/
    â”œâ”€â”€ dev-web.sh          # å¼€å‘ç¯å¢ƒå¯åŠ¨
    â”œâ”€â”€ build-web.sh        # ç”Ÿäº§æ„å»º
    â””â”€â”€ test-web.sh         # åŠŸèƒ½æµ‹è¯•
```

## âš¡ å¿«é€Ÿå¼€å§‹

### å¼€å‘ç¯å¢ƒ

```bash
# å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼ˆå‰åç«¯åŒæ—¶ï¼‰
./scripts/dev-web.sh

# è®¿é—®åœ°å€
# å‰ç«¯: http://localhost:3000
# åç«¯: http://localhost:8080
```

### ç”Ÿäº§æ„å»º

```bash
# æ„å»ºWebåº”ç”¨
./scripts/build-web.sh

# è¿è¡Œ
./tdl-web web --port 8080
```

### å•ç‹¬å¯åŠ¨

```bash
# ä»…å¯åŠ¨åç«¯APIæœåŠ¡å™¨
go run main.go web --port 8080

# ä»…å¯åŠ¨å‰ç«¯å¼€å‘æœåŠ¡å™¨
cd web/frontend && npm run dev
```

## ğŸ”§ å¼€å‘æŒ‡å—

### APIç«¯ç‚¹

#### è®¤è¯
- `GET /api/v1/auth/status` - è·å–è®¤è¯çŠ¶æ€
- `POST /api/v1/auth/login/qr` - äºŒç»´ç ç™»å½•
- `POST /api/v1/auth/login/code` - éªŒè¯ç ç™»å½•
- `POST /api/v1/auth/logout` - é€€å‡ºç™»å½•

#### ä¸‹è½½ç®¡ç†
- `GET /api/v1/download/chats` - è·å–èŠå¤©åˆ—è¡¨
- `POST /api/v1/download/start` - å¼€å§‹ä¸‹è½½ä»»åŠ¡
- `GET /api/v1/download/tasks` - è·å–ä¸‹è½½ä»»åŠ¡åˆ—è¡¨
- `DELETE /api/v1/download/tasks/:id` - å–æ¶ˆä¸‹è½½ä»»åŠ¡

#### ä¸Šä¼ ç®¡ç†
- `POST /api/v1/upload/start` - å¼€å§‹ä¸Šä¼ ä»»åŠ¡
- `GET /api/v1/upload/tasks` - è·å–ä¸Šä¼ ä»»åŠ¡åˆ—è¡¨
- `DELETE /api/v1/upload/tasks/:id` - å–æ¶ˆä¸Šä¼ ä»»åŠ¡

#### è®¾ç½®
- `GET /api/v1/settings/` - è·å–è®¾ç½®
- `PUT /api/v1/settings/` - æ›´æ–°è®¾ç½®

#### WebSocket
- `GET /ws` - WebSocketè¿æ¥ç«¯ç‚¹
- æ¶ˆæ¯ç±»å‹: `progress`, `task_start`, `task_end`, `task_error`, `notification`

### å‰ç«¯ç»„ä»¶

#### é¡µé¢ç»„ä»¶
- `LoginPage` - ç™»å½•é¡µé¢
- `DashboardPage` - ä»ªè¡¨æ¿
- `DownloadPage` - ä¸‹è½½ç®¡ç†
- `UploadPage` - ä¸Šä¼ ç®¡ç†  
- `SettingsPage` - è®¾ç½®é¡µé¢

#### çŠ¶æ€ç®¡ç†
- `useAuthStore` - è®¤è¯çŠ¶æ€
- `useTaskStore` - ä»»åŠ¡çŠ¶æ€
- `useWebSocket` - WebSocketè¿æ¥

## ğŸŒŸ æ ¸å¿ƒåŠŸèƒ½

### å·²å®ç°
- âœ… åŸºç¡€æ¶æ„æ­å»º
- âœ… APIæœåŠ¡å™¨(Gin)
- âœ… WebSocketå®æ—¶é€šä¿¡
- âœ… Reactå‰ç«¯æ¡†æ¶
- âœ… è·¯ç”±å’ŒçŠ¶æ€ç®¡ç†
- âœ… åŸºç¡€UIç»„ä»¶
- âœ… å¼€å‘å’Œæ„å»ºè„šæœ¬

### è®¡åˆ’ä¸­
- ğŸ”„ çœŸå®çš„Telegramè®¤è¯é›†æˆ
- ğŸ”„ æ–‡ä»¶ä¸‹è½½è¿›åº¦æ˜¾ç¤º
- ğŸ”„ æ‰¹é‡ä¸‹è½½ç®¡ç†
- ğŸ”„ ä¸Šä¼ åŠŸèƒ½å®ç°
- ğŸ”„ è®¾ç½®é¡µé¢å®Œå–„
- ğŸ”„ æ–‡ä»¶é¢„è§ˆåŠŸèƒ½
- ğŸ”„ ä»»åŠ¡å†å²è®°å½•

## ğŸ› æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **ç«¯å£è¢«å ç”¨**
   ```bash
   # æŸ¥æ‰¾å ç”¨è¿›ç¨‹
   lsof -ti:8080 | xargs kill -9
   ```

2. **å‰ç«¯ä¾èµ–å®‰è£…å¤±è´¥**
   ```bash
   # ä¿®å¤npmæƒé™
   sudo chown -R $(id -u):$(id -g) ~/.npm
   ```

3. **Goç¼–è¯‘é”™è¯¯**
   ```bash
   # æ¸…ç†æ¨¡å—ç¼“å­˜
   go clean -modcache && go mod tidy
   ```

### å¼€å‘è°ƒè¯•

```bash
# æŸ¥çœ‹å‰ç«¯æ—¥å¿—
tail -f web/frontend/vite.log

# æŸ¥çœ‹åç«¯æ—¥å¿—  
go run main.go web --port 8080 --debug

# æµ‹è¯•APIç«¯ç‚¹
./scripts/test-web.sh
```

## ğŸ“ å¼€å‘æ³¨æ„äº‹é¡¹

1. **APIå…¼å®¹æ€§**: å½“å‰å®ç°ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®ï¼Œéœ€è¦é€æ­¥é›†æˆçœŸå®çš„tdlåŠŸèƒ½
2. **çŠ¶æ€ç®¡ç†**: å‰ç«¯çŠ¶æ€ä¸åç«¯ä¿æŒåŒæ­¥ï¼Œé€šè¿‡WebSocketå®æ—¶æ›´æ–°
3. **é”™è¯¯å¤„ç†**: ç»Ÿä¸€çš„é”™è¯¯å“åº”æ ¼å¼å’Œç”¨æˆ·å‹å¥½çš„é”™è¯¯æç¤º
4. **æ€§èƒ½ä¼˜åŒ–**: å¤§æ–‡ä»¶ä¼ è¾“æ—¶çš„è¿›åº¦æ˜¾ç¤ºå’Œå†…å­˜ç®¡ç†
5. **å®‰å…¨æ€§**: è®¤è¯æœºåˆ¶å’ŒAPIæƒé™æ§åˆ¶

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. éµå¾ªç°æœ‰ä»£ç é£æ ¼å’Œæ¶æ„æ¨¡å¼
2. APIæ›´æ”¹éœ€è¦åŒæ­¥æ›´æ–°å‰ç«¯æ¥å£
3. æ·»åŠ æ–°åŠŸèƒ½æ—¶è€ƒè™‘WebSocketäº‹ä»¶é€šçŸ¥
4. ç¡®ä¿å“åº”å¼è®¾è®¡å’Œæ— éšœç¢æ”¯æŒ
5. ç¼–å†™ç›¸åº”çš„æµ‹è¯•ç”¨ä¾‹

---

ğŸ‰ **tdl Web Interfaceå·²å‡†å¤‡å°±ç»ªï¼** å¯ä»¥å¼€å§‹å¼€å‘ç°ä»£åŒ–çš„Telegramä¸‹è½½ç®¡ç†ç•Œé¢äº†ã€‚